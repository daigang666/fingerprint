var Fingerprint=(function(exports){'use strict';var d="DEVICE_FINGERPRINT",P="DeviceFingerprintDB",U="fingerprints";var T="X-Device-Fingerprint";function h(i,n){return i+n&4294967295}function R(i,n,e,t,r,o){let s=h(h(n,i),h(t,o));return h(s<<r|s>>>32-r,e)}function a(i,n,e,t,r,o,s){return R(n&e|~n&t,i,n,r,o,s)}function c(i,n,e,t,r,o,s){return R(n&t|e&~t,i,n,r,o,s)}function l(i,n,e,t,r,o,s){return R(n^e^t,i,n,r,o,s)}function u(i,n,e,t,r,o,s){return R(e^(n|~t),i,n,r,o,s)}function _(i,n){let e=i[0],t=i[1],r=i[2],o=i[3];e=a(e,t,r,o,n[0],7,-680876936),o=a(o,e,t,r,n[1],12,-389564586),r=a(r,o,e,t,n[2],17,606105819),t=a(t,r,o,e,n[3],22,-1044525330),e=a(e,t,r,o,n[4],7,-176418897),o=a(o,e,t,r,n[5],12,1200080426),r=a(r,o,e,t,n[6],17,-1473231341),t=a(t,r,o,e,n[7],22,-45705983),e=a(e,t,r,o,n[8],7,1770035416),o=a(o,e,t,r,n[9],12,-1958414417),r=a(r,o,e,t,n[10],17,-42063),t=a(t,r,o,e,n[11],22,-1990404162),e=a(e,t,r,o,n[12],7,1804603682),o=a(o,e,t,r,n[13],12,-40341101),r=a(r,o,e,t,n[14],17,-1502002290),t=a(t,r,o,e,n[15],22,1236535329),e=c(e,t,r,o,n[1],5,-165796510),o=c(o,e,t,r,n[6],9,-1069501632),r=c(r,o,e,t,n[11],14,643717713),t=c(t,r,o,e,n[0],20,-373897302),e=c(e,t,r,o,n[5],5,-701558691),o=c(o,e,t,r,n[10],9,38016083),r=c(r,o,e,t,n[15],14,-660478335),t=c(t,r,o,e,n[4],20,-405537848),e=c(e,t,r,o,n[9],5,568446438),o=c(o,e,t,r,n[14],9,-1019803690),r=c(r,o,e,t,n[3],14,-187363961),t=c(t,r,o,e,n[8],20,1163531501),e=c(e,t,r,o,n[13],5,-1444681467),o=c(o,e,t,r,n[2],9,-51403784),r=c(r,o,e,t,n[7],14,1735328473),t=c(t,r,o,e,n[12],20,-1926607734),e=l(e,t,r,o,n[5],4,-378558),o=l(o,e,t,r,n[8],11,-2022574463),r=l(r,o,e,t,n[11],16,1839030562),t=l(t,r,o,e,n[14],23,-35309556),e=l(e,t,r,o,n[1],4,-1530992060),o=l(o,e,t,r,n[4],11,1272893353),r=l(r,o,e,t,n[7],16,-155497632),t=l(t,r,o,e,n[10],23,-1094730640),e=l(e,t,r,o,n[13],4,681279174),o=l(o,e,t,r,n[0],11,-358537222),r=l(r,o,e,t,n[3],16,-722521979),t=l(t,r,o,e,n[6],23,76029189),e=l(e,t,r,o,n[9],4,-640364487),o=l(o,e,t,r,n[12],11,-421815835),r=l(r,o,e,t,n[15],16,530742520),t=l(t,r,o,e,n[2],23,-995338651),e=u(e,t,r,o,n[0],6,-198630844),o=u(o,e,t,r,n[7],10,1126891415),r=u(r,o,e,t,n[14],15,-1416354905),t=u(t,r,o,e,n[5],21,-57434055),e=u(e,t,r,o,n[12],6,1700485571),o=u(o,e,t,r,n[3],10,-1894986606),r=u(r,o,e,t,n[10],15,-1051523),t=u(t,r,o,e,n[1],21,-2054922799),e=u(e,t,r,o,n[8],6,1873313359),o=u(o,e,t,r,n[15],10,-30611744),r=u(r,o,e,t,n[6],15,-1560198380),t=u(t,r,o,e,n[13],21,1309151649),e=u(e,t,r,o,n[4],6,-145523070),o=u(o,e,t,r,n[11],10,-1120210379),r=u(r,o,e,t,n[2],15,718787259),t=u(t,r,o,e,n[9],21,-343485551),i[0]=h(e,i[0]),i[1]=h(t,i[1]),i[2]=h(r,i[2]),i[3]=h(o,i[3]);}function H(i){let n=[];for(let e=0;e<64;e+=4)n[e>>2]=i.charCodeAt(e)+(i.charCodeAt(e+1)<<8)+(i.charCodeAt(e+2)<<16)+(i.charCodeAt(e+3)<<24);return n}function X(i){let n="0123456789abcdef",e="";for(let t=0;t<4;t++)e+=n.charAt(i>>t*8+4&15)+n.charAt(i>>t*8&15);return e}function W(i){return i.map(X).join("")}function K(i){return unescape(encodeURIComponent(i))}function O(i){let n=K(i),e=n.length,t=[1732584193,-271733879,-1732584194,271733878],r;for(r=64;r<=e;r+=64)_(t,H(n.substring(r-64,r)));let o=n.substring(r-64),s=Array(16).fill(0);for(r=0;r<o.length;r++)s[r>>2]|=o.charCodeAt(r)<<(r%4<<3);return s[r>>2]|=128<<(r%4<<3),r>55&&(_(t,s),s.fill(0)),s[14]=e*8,_(t,s),W(t)}function N(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID().replace(/-/g,""):"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/x/g,()=>Math.floor(Math.random()*16).toString(16))}var x=class{constructor(){this.name="canvas";}async collect(n){try{let e=document.createElement("canvas"),t=e.getContext("2d");if(!t)return {name:this.name,value:"",success:!1,error:"Canvas context not available"};e.width=200,e.height=50,t.fillStyle="#f60",t.fillRect(0,0,200,50),t.fillStyle="#069",t.font="14px Arial",t.fillText("Device Fingerprint Canvas",2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.font="18px Times New Roman",t.fillText("!@#$%^&*()_+-=[]{}|;:",4,35),t.beginPath(),t.arc(150,25,20,0,Math.PI*2,!0),t.closePath(),t.fillStyle="#ff0",t.fill(),t.shadowBlur=10,t.shadowColor="blue",t.fillRect(160,10,30,30);let r=e.toDataURL("image/png");return {name:this.name,value:r,success:!0}}catch(e){return {name:this.name,value:"",success:false,error:e instanceof Error?e.message:"Unknown error"}}}};var C=class{constructor(){this.name="webgl";}async collect(n){try{let e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)return {name:this.name,value:"",success:!1,error:"WebGL not available"};let r=t,o=r.getExtension("WEBGL_debug_renderer_info"),s=[];if(o){let p=r.getParameter(o.UNMASKED_VENDOR_WEBGL),B=r.getParameter(o.UNMASKED_RENDERER_WEBGL);s.push(`vendor:${p}`),s.push(`renderer:${B}`);}s.push(`version:${r.getParameter(r.VERSION)}`),s.push(`shadingLanguageVersion:${r.getParameter(r.SHADING_LANGUAGE_VERSION)}`),s.push(`maxTextureSize:${r.getParameter(r.MAX_TEXTURE_SIZE)}`),s.push(`maxRenderbufferSize:${r.getParameter(r.MAX_RENDERBUFFER_SIZE)}`),s.push(`maxViewportDims:${r.getParameter(r.MAX_VIEWPORT_DIMS)}`),s.push(`maxVertexAttribs:${r.getParameter(r.MAX_VERTEX_ATTRIBS)}`),s.push(`maxVertexUniformVectors:${r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS)}`),s.push(`maxFragmentUniformVectors:${r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS)}`);let m=r.getSupportedExtensions()||[];return s.push(`extensions:${m.sort().join(",")}`),{name:this.name,value:s.join("|"),success:!0}}catch(e){return {name:this.name,value:"",success:false,error:e instanceof Error?e.message:"Unknown error"}}}};var b=class{constructor(){this.name="audio";}async collect(n){try{let e=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(!e)return {name:this.name,value:"",success:!1,error:"OfflineAudioContext not available"};let t=44100,o=t*.5,s=new e(1,o,t),m=s.createOscillator();m.type="triangle",m.frequency.setValueAtTime(1e4,s.currentTime);let p=s.createDynamicsCompressor();p.threshold.setValueAtTime(-50,s.currentTime),p.knee.setValueAtTime(40,s.currentTime),p.ratio.setValueAtTime(12,s.currentTime),p.attack.setValueAtTime(0,s.currentTime),p.release.setValueAtTime(.25,s.currentTime),m.connect(p),p.connect(s.destination),m.start(0);let $=(await s.startRendering()).getChannelData(0),f=[],j=[4500,5e3,5500,6e3,6500,7e3,7500,8e3,8500,9e3,9500,1e4,10500,11e3,11500,12e3,12500,13e3,13500,14e3];for(let g of j)g<$.length&&f.push($[g]);let M=f.reduce((g,S)=>g+S,0)/f.length,G=f.reduce((g,S)=>g+Math.pow(S-M,2),0)/f.length,L=[...f.map(g=>g.toFixed(8)),`avg:${M.toFixed(8)}`,`var:${G.toFixed(8)}`].join(",");return {name:this.name,value:L,success:!0}}catch(e){return {name:this.name,value:"",success:false,error:e instanceof Error?e.message:"Unknown error"}}}};var v=class{constructor(){this.name="screen";}async collect(n){try{let e=[];e.push(`width:${screen.width}`),e.push(`height:${screen.height}`),e.push(`availWidth:${screen.availWidth}`),e.push(`availHeight:${screen.availHeight}`),e.push(`colorDepth:${screen.colorDepth}`),e.push(`pixelDepth:${screen.pixelDepth}`),e.push(`devicePixelRatio:${window.devicePixelRatio||1}`),screen.orientation&&e.push(`orientation:${screen.orientation.type}`);let t=navigator.maxTouchPoints||0;return e.push(`maxTouchPoints:${t}`),e.push(`touchSupport:${t>0}`),{name:this.name,value:e.join("|"),success:!0}}catch(e){return {name:this.name,value:"",success:false,error:e instanceof Error?e.message:"Unknown error"}}}};var y=class{constructor(){this.name="system";}async collect(n){try{let e=[];n?.strictBrowserMode&&e.push(`userAgent:${navigator.userAgent}`),e.push(`timezone:${Intl.DateTimeFormat().resolvedOptions().timeZone}`),e.push(`timezoneOffset:${new Date().getTimezoneOffset()}`),e.push(`language:${navigator.language}`),e.push(`languages:${(navigator.languages||[]).join(",")}`),e.push(`hardwareConcurrency:${navigator.hardwareConcurrency||"unknown"}`);let t=navigator.deviceMemory;t&&e.push(`deviceMemory:${t}`),e.push(`platform:${navigator.platform}`),e.push(`cookieEnabled:${navigator.cookieEnabled}`),e.push(`javaEnabled:${typeof navigator.javaEnabled=="function"?navigator.javaEnabled():!1}`);let r=navigator.doNotTrack||window.doNotTrack;return e.push(`doNotTrack:${r||"unknown"}`),e.push(`pdfViewerEnabled:${navigator.pdfViewerEnabled??"unknown"}`),e.push(`webdriver:${navigator.webdriver||!1}`),{name:this.name,value:e.join("|"),success:!0}}catch(e){return {name:this.name,value:"",success:false,error:e instanceof Error?e.message:"Unknown error"}}}};function V(){return [new x,new C,new b,new v,new y]}var A=class{constructor(n){this.key=n?`${n}_${d}`:d;}async get(){try{let n=localStorage.getItem(this.key);return n?JSON.parse(n):null}catch{return null}}async set(n){try{localStorage.setItem(this.key,JSON.stringify(n));}catch(e){console.warn("[Fingerprint] Failed to save to localStorage:",e);}}async clear(){try{localStorage.removeItem(this.key);}catch{}}};var D=class{constructor(n){this.db=null;this.dbName=n?`${n}_${P}`:P,this.storeName=U,this.key=d;}async openDB(){return this.db?this.db:new Promise((n,e)=>{let t=indexedDB.open(this.dbName,1);t.onerror=()=>{e(new Error("Failed to open IndexedDB"));},t.onsuccess=()=>{this.db=t.result,n(t.result);},t.onupgradeneeded=r=>{let o=r.target.result;o.objectStoreNames.contains(this.storeName)||o.createObjectStore(this.storeName,{keyPath:"id"});};})}async get(){try{let n=await this.openDB();return new Promise(e=>{let o=n.transaction(this.storeName,"readonly").objectStore(this.storeName).get(this.key);o.onerror=()=>{e(null);},o.onsuccess=()=>{let s=o.result;s&&s.data?e(s.data):e(null);};})}catch{return null}}async set(n){try{let e=await this.openDB();return new Promise((t,r)=>{let m=e.transaction(this.storeName,"readwrite").objectStore(this.storeName).put({id:this.key,data:n});m.onerror=()=>{r(new Error("Failed to save to IndexedDB"));},m.onsuccess=()=>{t();};})}catch(e){console.warn("[Fingerprint] Failed to save to IndexedDB:",e);}}async clear(){try{let n=await this.openDB();return new Promise(e=>{n.transaction(this.storeName,"readwrite").objectStore(this.storeName).delete(this.key),e();})}catch{}}};var E=class{constructor(n={}){this.cachedResult=null;this.config={cacheExpiry:n.cacheExpiry??63072e7,enableIndexedDB:n.enableIndexedDB??true,storageKeyPrefix:n.storageKeyPrefix??"df",version:n.version??1,strictBrowserMode:n.strictBrowserMode??false},this.collectors=V(),this.localStorage=new A(this.config.storageKeyPrefix),this.indexedDB=this.config.enableIndexedDB?new D(this.config.storageKeyPrefix):null;}async getFingerprint(){if(this.cachedResult&&!this.isExpired(this.cachedResult.expiresAt))return this.cachedResult;let n=await this.localStorage.get();if(n&&!this.isExpired(n.expiresAt))return this.cachedResult=this.toResult(n),this.cachedResult;if(this.indexedDB){let e=await this.indexedDB.get();if(e&&!this.isExpired(e.expiresAt))return await this.localStorage.set(e),this.cachedResult=this.toResult(e),this.cachedResult}return this.collectAndCache()}async refresh(){return this.collectAndCache()}async clear(){this.cachedResult=null,await this.localStorage.clear(),this.indexedDB&&await this.indexedDB.clear();}async collectAndCache(){let{fingerprint:n,isFallback:e}=await this.collect(),t=Date.now(),r={fingerprint:n,isFallback:e,createdAt:t,expiresAt:t+this.config.cacheExpiry,version:this.config.version};return await this.localStorage.set(r),this.indexedDB&&await this.indexedDB.set(r),this.cachedResult=this.toResult(r),this.cachedResult}async collect(){try{let n={strictBrowserMode:this.config.strictBrowserMode},t=(await Promise.all(this.collectors.map(o=>o.collect(n)))).filter(o=>o.success&&o.value);if(t.length===0)return {fingerprint:N(),isFallback:!0};let r=t.map(o=>`${o.name}:${o.value}`).sort().join("|");return {fingerprint:O(r),isFallback:!1}}catch(n){return console.warn("[Fingerprint] Collection failed, using fallback UUID:",n),{fingerprint:N(),isFallback:true}}}isExpired(n){return Date.now()>n}toResult(n){return {fingerprint:n.fingerprint,isFallback:n.isFallback,timestamp:n.createdAt,expiresAt:n.expiresAt}}};var F=null;function Te(i){F=new E(i);}function I(){return F||(F=new E),F}async function _e(){return I().getFingerprint()}async function Ne(){return (await I().getFingerprint()).fingerprint}async function Be(){return I().refresh()}async function $e(){return I().clear()}function Me(){return T}exports.HTTP_HEADER_NAME=T;exports.clearFingerprint=$e;exports.getDeviceFingerprint=_e;exports.getFingerprint=Ne;exports.getHeaderName=Me;exports.initFingerprint=Te;exports.refreshFingerprint=Be;return exports;})({});//# sourceMappingURL=index.browser.js.map
//# sourceMappingURL=index.browser.js.map